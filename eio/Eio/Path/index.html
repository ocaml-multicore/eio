<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Path (eio.Eio.Path)</title><link rel="stylesheet" href="../../../_odoc_support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../_odoc_support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">eio</a> &#x00BB; <a href="../index.html">Eio</a> &#x00BB; Path</nav><header class="odoc-preamble"><h1>Module <code><span>Eio.Path</span></code></h1><p>Accessing paths on a file-system.</p><p>A <code>_ Path.t</code> represents a particular location in some filesystem. It is a pair of a base directory and a relative path from there.</p><p><a href="../Stdenv/index.html#val-cwd"><code>Eio.Stdenv.cwd</code></a> provides access to the current working directory. For example:</p><pre class="language-ocaml"><code>let ( / ) = Eio.Path.( / )

let run dir =
  Eio.Path.save ~create:(`Exclusive 0o600)
    (dir / &quot;output.txt&quot;) &quot;the data&quot;

let () =
  Eio_main.run @@ fun env -&gt;
  run (Eio.Stdenv.cwd env)</code></pre><p>It is normally not permitted to access anything above the base directory, even by following a symlink. The exception is <a href="../Stdenv/index.html#val-fs"><code>Stdenv.fs</code></a>, which provides access to the whole file-system:</p><pre class="language-ocaml"><code>Eio.Path.load (fs / &quot;/etc/passwd&quot;)</code></pre></header><nav class="odoc-toc"><ul><li><a href="#reading-files">Reading files</a></li><li><a href="#writing-files">Writing files</a></li><li><a href="#directories">Directories</a></li><li><a href="#other">Other</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span><span> = <a href="../Fs/class-dir/index.html">Fs.dir</a> <span class="keyword">as</span> 'a * <a href="../Fs/index.html#type-path">Fs.path</a></span></code></div><div class="spec-doc"><p>An OS directory FD and a path relative to it, for use with e.g. <code>openat(2)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(/)"><a href="#val-(/)" class="anchor"></a><code><span><span class="keyword">val</span> (/) : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>t / step</code> is <code>t</code> with <code>step</code> appended to <code>t</code>'s path, or replacing <code>t</code>'s path if <code>step</code> is absolute:</p><ul><li><code>(fd, &quot;foo&quot;) / &quot;bar&quot; = (fd, &quot;foo/bar&quot;)</code></li><li><code>(fd, &quot;foo&quot;) / &quot;/bar&quot; = (fd, &quot;/bar&quot;)</code></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp</code> formats a <code>_ t</code> as &quot;&lt;label:path&gt;&quot;, suitable for logging.</p></div></div><h2 id="reading-files"><a href="#reading-files" class="anchor"></a>Reading files</h2><div class="odoc-spec"><div class="spec value anchored" id="val-load"><a href="#val-load" class="anchor"></a><code><span><span class="keyword">val</span> load : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>load t</code> returns the contents of the given file.</p><p>This is a convenience wrapper around <a href="#val-with_open_in"><code>with_open_in</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-open_in"><a href="#val-open_in" class="anchor"></a><code><span><span class="keyword">val</span> open_in : <span>sw:<a href="../Switch/index.html#type-t">Switch.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>&lt; <a href="../File/class-ro/index.html">File.ro</a> ; <a href="../Flow/class-type-close/index.html">Flow.close</a> &gt;</span></span></code></div><div class="spec-doc"><p><code>open_in ~sw t</code> opens <code>t</code> for reading.</p><p>Note: files are always opened in binary mode.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_open_in"><a href="#val-with_open_in" class="anchor"></a><code><span><span class="keyword">val</span> with_open_in : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span>&lt; <a href="../File/class-ro/index.html">File.ro</a> ; <a href="../Flow/class-type-close/index.html">Flow.close</a> &gt;</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_open_in</code> is like <code>open_in</code>, but calls <code>fn flow</code> with the new flow and closes it automatically when <code>fn</code> returns (if it hasn't already been closed by then).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_lines"><a href="#val-with_lines" class="anchor"></a><code><span><span class="keyword">val</span> with_lines : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span>string <span class="xref-unresolved">Stdlib</span>.Seq.t</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_lines t fn</code> is a convenience function for streaming the lines of the file.</p><p>It uses <a href="../Buf_read/index.html#val-lines"><code>Buf_read.lines</code></a>.</p></div></div><h2 id="writing-files"><a href="#writing-files" class="anchor"></a>Writing files</h2><div class="odoc-spec"><div class="spec value anchored" id="val-save"><a href="#val-save" class="anchor"></a><code><span><span class="keyword">val</span> save : <span>?append:bool <span class="arrow">&#45;&gt;</span></span> <span>create:<a href="../Fs/index.html#type-create">Fs.create</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>save t data ~create</code> writes <code>data</code> to <code>t</code>.</p><p>This is a convenience wrapper around <a href="#val-with_open_out"><code>with_open_out</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-open_out"><a href="#val-open_out" class="anchor"></a><code><span><span class="keyword">val</span> open_out : 
  <span>sw:<a href="../Switch/index.html#type-t">Switch.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?append:bool <span class="arrow">&#45;&gt;</span></span>
  <span>create:<a href="../Fs/index.html#type-create">Fs.create</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>&lt; <a href="../File/class-rw/index.html">File.rw</a>
  ; <a href="../Flow/class-type-close/index.html">Flow.close</a> &gt;</span></span></code></div><div class="spec-doc"><p><code>open_out ~sw t</code> opens <code>t</code> for reading and writing.</p><p>Note: files are always opened in binary mode.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">append</span> <p>Open for appending: always write at end of file.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">create</span> <p>Controls whether to create the file, and what permissions to give it if so.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_open_out"><a href="#val-with_open_out" class="anchor"></a><code><span><span class="keyword">val</span> with_open_out : 
  <span>?append:bool <span class="arrow">&#45;&gt;</span></span>
  <span>create:<a href="../Fs/index.html#type-create">Fs.create</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span>&lt; <a href="../File/class-rw/index.html">File.rw</a> ; <a href="../Flow/class-type-close/index.html">Flow.close</a> &gt;</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_open_out</code> is like <code>open_out</code>, but calls <code>fn flow</code> with the new flow and closes it automatically when <code>fn</code> returns (if it hasn't already been closed by then).</p></div></div><h2 id="directories"><a href="#directories" class="anchor"></a>Directories</h2><div class="odoc-spec"><div class="spec value anchored" id="val-mkdir"><a href="#val-mkdir" class="anchor"></a><code><span><span class="keyword">val</span> mkdir : <span>perm:<a href="../File/Unix_perm/index.html#type-t">File.Unix_perm.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>mkdir ~perm t</code> creates a new directory <code>t</code> with permissions <code>perm</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-open_dir"><a href="#val-open_dir" class="anchor"></a><code><span><span class="keyword">val</span> open_dir : <span>sw:<a href="../Switch/index.html#type-t">Switch.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>&lt; <a href="../Fs/class-dir/index.html">Fs.dir</a> ; <a href="../Flow/class-type-close/index.html">Flow.close</a> &gt;</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>open_dir ~sw t</code> opens <code>t</code>.</p><p>This can be passed to functions to grant access only to the subtree <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_open_dir"><a href="#val-with_open_dir" class="anchor"></a><code><span><span class="keyword">val</span> with_open_dir : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span><span>&lt; <a href="../Fs/class-dir/index.html">Fs.dir</a> ; <a href="../Flow/class-type-close/index.html">Flow.close</a> &gt;</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_open_dir</code> is like <code>open_dir</code>, but calls <code>fn dir</code> with the new directory and closes it automatically when <code>fn</code> returns (if it hasn't already been closed by then).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_dir"><a href="#val-read_dir" class="anchor"></a><code><span><span class="keyword">val</span> read_dir : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string list</span></span></code></div><div class="spec-doc"><p><code>read_dir t</code> reads directory entries for <code>t</code>.</p><p>The entries are sorted using <code>String</code>.compare.</p><p>Note: The special Unix entries &quot;.&quot; and &quot;..&quot; are not included in the results.</p></div></div><h2 id="other"><a href="#other" class="anchor"></a>Other</h2><div class="odoc-spec"><div class="spec value anchored" id="val-unlink"><a href="#val-unlink" class="anchor"></a><code><span><span class="keyword">val</span> unlink : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>unlink t</code> removes directory entry <code>t</code>.</p><p>Note: this cannot be used to unlink directories. Use <a href="#val-rmdir"><code>rmdir</code></a> for directories.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rmdir"><a href="#val-rmdir" class="anchor"></a><code><span><span class="keyword">val</span> rmdir : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>rmdir t</code> removes directory entry <code>t</code>. This only works when the entry is itself a directory.</p><p>Note: this usually requires the directory to be empty.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rename"><a href="#val-rename" class="anchor"></a><code><span><span class="keyword">val</span> rename : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>rename old_t new_t</code> atomically unlinks <code>old_t</code> and links it as <code>new_t</code>.</p><p>If <code>new_t</code> already exists, it is atomically replaced.</p></div></div></div></body></html>