<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Eio (eio.Eio)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.0.0-823-ge94c197"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">eio</a> &#x00BB; Eio</nav><header class="odoc-preamble"><h1>Module <code><span>Eio</span></code></h1><p>Effects based parallel IO for OCaml.</p><p>Eio provides support for concurrency (juggling many tasks) and parallelism (using multiple CPU cores for performance).</p><p>It provides facilities for creating and coordinating fibers (light-weight threads) and domains (for parallel processing), as well as interfaces for interacting with resources provided by the operating system.</p><p>These features must be used within an <em>event loop</em>, provided by an Eio <em>backend</em>. Applications can use <code>Eio_main.run</code> to run a suitable loop.</p><p>See <a href="https://github.com/ocaml-multicore/eio">https://github.com/ocaml-multicore/eio</a> for a tutorial.</p></header><nav class="odoc-toc"><ul><li><a href="#fibers">Fibers</a></li><li><a href="#concurrency-primitives">Concurrency primitives</a></li><li><a href="#collections">Collections</a></li><li><a href="#multiple-domains">Multiple domains</a></li><li><a href="#errors-and-debugging">Errors and debugging</a></li><li><a href="#cross-platform-os-api">Cross-platform OS API</a><ul><li><a href="#byte-streams">Byte streams</a></li><li><a href="#networking">Networking</a></li><li><a href="#file-systems">File-systems</a></li><li><a href="#processes">Processes</a></li><li><a href="#time">Time</a></li><li><a href="#main-env">Main env</a></li></ul></li><li><a href="#provider-api-for-os-schedulers">Provider API for OS schedulers</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Std"><a href="#module-Std" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Std/index.html">Std</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Commonly used standard features. This module is intended to be <code>open</code>ed.</p></div></div><h2 id="fibers"><a href="#fibers" class="anchor"></a>Fibers</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Switch"><a href="#module-Switch" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Switch/index.html">Switch</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Grouping fibers and other resources so they can be turned off together.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Fiber"><a href="#module-Fiber" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Fiber/index.html">Fiber</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A fiber is a light-weight thread.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Cancel"><a href="#module-Cancel" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Cancel/index.html">Cancel</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Cancelling fibers.</p></div></div><h2 id="concurrency-primitives"><a href="#concurrency-primitives" class="anchor"></a>Concurrency primitives</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Promise"><a href="#module-Promise" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Promise/index.html">Promise</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A promise is a placeholder for result that will arrive in the future.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Semaphore"><a href="#module-Semaphore" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Semaphore/index.html">Semaphore</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A counting semaphore.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Mutex"><a href="#module-Mutex" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Mutex/index.html">Mutex</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Mutual exclusion.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Condition"><a href="#module-Condition" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Condition/index.html">Condition</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Waiting for a condition to become true.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Lazy"><a href="#module-Lazy" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Lazy/index.html">Lazy</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Delayed evaluation.</p></div></div><h2 id="collections"><a href="#collections" class="anchor"></a>Collections</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Stream"><a href="#module-Stream" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Stream/index.html">Stream</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A stream/queue.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Pool"><a href="#module-Pool" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Pool/index.html">Pool</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A pool of resources.</p></div></div><h2 id="multiple-domains"><a href="#multiple-domains" class="anchor"></a>Multiple domains</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Domain_manager"><a href="#module-Domain_manager" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Domain_manager/index.html">Domain_manager</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Parallel computation across multiple CPU cores.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Executor_pool"><a href="#module-Executor_pool" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Executor_pool/index.html">Executor_pool</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A pool of domains for executing jobs.</p></div></div><h2 id="errors-and-debugging"><a href="#errors-and-debugging" class="anchor"></a>Errors and debugging</h2><div class="odoc-spec"><div class="spec value anchored" id="val-traceln"><a href="#val-traceln" class="anchor"></a><code><span><span class="keyword">val</span> traceln : 
  <span><span class="optlabel">?__POS__</span>:<span>(string * int * int * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit, unit)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>traceln fmt</code> outputs a debug message (typically to stderr).</p><p>Trace messages are printed by default and do not require logging to be configured first. The message is printed with a newline, and is flushed automatically. <code>traceln</code> is intended for quick debugging rather than for production code.</p><p>Unlike most Eio operations, <code>traceln</code> will never switch to another fiber; if the OS is not ready to accept the message then the whole domain waits.</p><p>It is safe to call <code>traceln</code> from multiple domains at the same time. Each line will be written atomically.</p><p>Examples:</p><pre class="language-ocaml"><code>traceln &quot;x = %d&quot; x;
traceln &quot;x = %d&quot; x ~__POS__;   (* With location information *)</code></pre><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">__POS__</span> <p>Display <code>__POS__</code> as the location of the <code>traceln</code> call.</p></li></ul></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Exn"><a href="#module-Exn" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Exn/index.html">Exn</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Eio exceptions.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Io"><a href="#exception-Io" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Io</span> <span class="keyword">of</span> <a href="Exn/index.html#type-err">Exn.err</a> * <a href="Exn/index.html#type-context">Exn.context</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Debug"><a href="#module-Debug" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Debug/index.html">Debug</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Control over debugging.</p></div></div><h2 id="cross-platform-os-api"><a href="#cross-platform-os-api" class="anchor"></a>Cross-platform OS API</h2><p>The general pattern here is that each type of resource has a set of functions for using it, plus a provider (<code>Pi</code>) module to allow defining your own implementations.</p><p>The system resources are available from the environment argument provided by your event loop (e.g. <code>Eio_main.run</code>).</p><div class="odoc-spec"><div class="spec module anchored" id="module-Resource"><a href="#module-Resource" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Resource/index.html">Resource</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Defines the base resource type.</p></div></div><h3 id="byte-streams"><a href="#byte-streams" class="anchor"></a>Byte streams</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Flow"><a href="#module-Flow" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Flow/index.html">Flow</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A flow can be used to read or write bytes.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Buf_read"><a href="#module-Buf_read" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Buf_read/index.html">Buf_read</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Buffered input and parsing.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Buf_write"><a href="#module-Buf_write" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Buf_write/index.html">Buf_write</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Buffered output and formatting.</p></div></div><h3 id="networking"><a href="#networking" class="anchor"></a>Networking</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Net"><a href="#module-Net" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Net/index.html">Net</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Network sockets and addresses.</p></div></div><h3 id="file-systems"><a href="#file-systems" class="anchor"></a>File-systems</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Path"><a href="#module-Path" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Path/index.html">Path</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Accessing paths on a file-system.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-File"><a href="#module-File" class="anchor"></a><code><span><span class="keyword">module</span> <a href="File/index.html">File</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Operations on open files.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Fs"><a href="#module-Fs" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Fs/index.html">Fs</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>File-system types.</p></div></div><h3 id="processes"><a href="#processes" class="anchor"></a>Processes</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Process"><a href="#module-Process" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Process/index.html">Process</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Managing child processes.</p></div></div><h3 id="time"><a href="#time" class="anchor"></a>Time</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Time"><a href="#module-Time" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Time/index.html">Time</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Clocks, time, sleeping and timeouts.</p></div></div><h3 id="main-env"><a href="#main-env" class="anchor"></a>Main env</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Stdenv"><a href="#module-Stdenv" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Stdenv/index.html">Stdenv</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The standard environment of a process.</p></div></div><h2 id="provider-api-for-os-schedulers"><a href="#provider-api-for-os-schedulers" class="anchor"></a>Provider API for OS schedulers</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Private"><a href="#module-Private" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Private/index.html">Private</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>API for use by the scheduler implementation.</p></div></div></div></body></html>
